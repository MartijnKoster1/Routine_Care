---
title: "Assignment"
author:  
- Ibrahm Ayhan, student nr
- Valerie Habbel, student nr
- Martijn Koster, 6234119
- Jurrian van de Kraats, student nr
- Tim Poorthuis, student nr

date: "2023-02-15"
output:
  bookdown::pdf_document2:
    extra_dependencies: "subfig" 
    toc: false 
    number_sections: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, comment = NA, warning = FALSE,
                      error=FALSE, results='hide',fig.keep='all')
```

# Introduction

```{r, include=FALSE}
library(rms)
library(tidyverse)
library(kableExtra)
library(psych)
```


```{r, include = FALSE}
data <- read.table("data.txt", sep="\t")
attach(data)
```

```{r}
des <- describe(data)
tab1 <- data.frame(
  variables = colnames(data), 
  min.var = des$min, 
  max.var = des$max,
  mean.var = des$mean, 
  n.var = des$n
)
```


```{r des, echo = FALSE, results='hold'}
tab1 %>%
  kbl(caption = 'Descriptive statistics in the dataset',
      col.names = c('Variables', 'Min', 'Max', 'Mean', 'N'),
      booktabs = T) %>%
  kable_classic(full_width = F, html_font = 'Cambria') %>% 
  kable_styling(latex_options = "hold_position")

```

```{r}
#Distribution of the people who ot hopsitalized
table(data$hosp==1)
```

```{r}
#Distribution of the exposure
table(data$vacc==1)
```





Write here a short motivation with a RQ 

- well articulated RQ

__The aim of the study is to assess whether annual influenza vaccination reduces the risk of hospitalization among elderly (i.e., people aged >=65 years).__ 

- Selection of confounders? or in methods

# Methods

- Selection of confounders? or in intro? 

I'd say we use `age`, `cvd`, `DM` `contact`, based on a DAG? 

- Methods to control for (observed/unobserved confounding)


We will develop a propensity score model and calculate Inverse probability weighting

```{r}
mean(age[vacc==0]); mean(age[vacc==1]) #mean age per exposure status
mean(contact[vacc==0]); mean(contact[vacc==1]) #mean contact with GP in 12 months per exposure status
table(vacc, pulm)
table(vacc, cvd)
```


```{r}
ps.formula <- vacc ~ rcs(age) + cvd + DM * rcs(contact)

ps.fit <- lrm(ps.formula, data=data)
ps.fit$stats['C']
```



- Checking assumptions of method to control for confounding

- Implementation of methods to control for (observed/unobserved) confounding

- Make a DAG? 

# Results

- Reporting characteristics of study population 

- Reporting crude/adjusted effect measures 

# Conclusion / Discussion

- Conclusions supported by data

- Other issues (both postive and negative) 




